# 등차수열 만들기

**제한 시간: 1 초**

$N$개의 정수로 이루어진 수열 $A$가 있습니다.

당신은 $1 < i < N$ 인 (즉, 2번째부터 $N-1$번째) 원소 $A[i]$에 대해 "수정 연산"을 수행할 수 있습니다.

* **수정 연산**: $A[i]$의 값을 $A[i-1] + A[i+1] - A[i]$ 로 변경합니다.

이 연산은, $A[i-1], A[i], A[i+1]$ 이 등차수열을 이루도록 $A[i]$의 값을 강제로 조절하는 것과 같습니다.

**목표:** 주어진 수열 $A$ 전체가 등차수열이 되도록 하기 위해 필요한 "수정 연산"의 **최소 횟수**를 구하는 프로그램을 작성하시오.

---

### Input

* 첫 번째 줄에 수열의 크기 $N$ ($3 \le N \le 2,500$)이 주어집니다.
* 두 번째 줄에 $N$개의 정수 $A_0, A_1, \dots, A_{N-1}$ ( $|A_i| \le 10^9$ ) 이 공백으로 구분되어 주어집니다. (인덱스는 0부터 시작합니다.)

### Output

* 수열 전체가 등차수열이 되도록 만드는 데 필요한 최소 연산 횟수를 출력합니다.

---

### Sample Input 1
5 1 3 4 7 9

### Sample Output 1

1

**설명:**
만약 0번 원소(1)와 3번 원소(7)를 **수정하지 않고 그대로 둔다면**, 이 두 원소는 공차 $d = (7-1)/(3-0) = 2$ 인 등차수열 `[1, 3, 5, 7, 9]` 를 정의합니다.

* **원본 수열:** `[1, 3, 4, 7, 9]`
* **목표 수열:** `[1, 3, 5, 7, 9]`

원본 수열에서 0, 1, 3, 4번 인덱스의 값(총 4개)이 목표 수열과 일치합니다. 2번 인덱스의 값(4)만 5로 **1번 수정**하면 목표를 달성할 수 있습니다.

### Sample Input 2

5 1 10 2 20 3

### Sample Output 2

3

**설명:**
만약 1번 원소(10)와 3번 원소(20)를 **수정하지 않고 그대로 둔다면**, 공차 $d = (20-10)/(3-1) = 5$ 인 등차수열 `[5, 10, 15, 20, 25]` 가 정의됩니다.

* **원본 수열:** `[1, 10, 2, 20, 3]`
* **목표 수열:** `[5, 10, 15, 20, 25]`

원본 수열에서 2개의 원소(10, 20)만 목표와 일치합니다. 나머지 3개의 원소(1, 2, 3)는 수정해야 합니다.
따라서 최소 3번의 연산이 필요합니다.


### 난이도 분석

1.  **개인적으로 생각하는 함정:**  
    
    $N$이 2,500이므로 $O(N^3)$이나 $O(N^4)$ 풀이는 안 됩니다.

    이 문제를 "어떤 순서로 연산을 해야 최소일까?"라고 생각하면,

    현재 $A[i]$를 바꾸면 $A[i-1]$과 $A[i+1]$의 연산에 영향을 주므로 
    매우 복잡한 DP나 BFS처럼 보입니다. 

2.  **핵심 기믹 (문제 변환):**
    
    * "최소 연산 횟수"를 구하라는 것은, 반대로 "연산하지 않고 **그대로 둘** 원소의 **최대 개수**"를 찾으라는 말과 같습니다.
    
    * 답 = $N$ - (그대로 둘 원소의 최대 개수 $k$)

3.  **문제:**
    
    * 등차수열은 **단 두 개의 점**만 정해지면 유일하게 결정됩니다. 
    
    ( $A[i]$와 $A[j]$가 정해지면 공차 $d = (A[j] - A[i]) / (j - i)$ 와 첫째 항 $a_0 = A[i] - i \times d$ 가 결정됩니다.)
    
    * 따라서, 이 문제는 **$N$개의 (인덱스, 값) 쌍 $(i, A[i])$ 중에서, 동일한 직선 위에 있는 최대 점의 개수 $k$를 찾는 문제**로 바뀝니다.
    
    * $N$개의 점 중 2개의 점 $(i, A[i])$와 $(j, A[j])$를 ($O(N^2)$) 골라서 이 두 점을 지나는 직선(등차수열)을 정의합니다.
    
    * 이때, 공차 $d$가 정수가 아니면 (즉, $A[j] - A[i]$ 가 $j - i$ 로 나누어 떨어지지 않으면) 유효한 등차수열이 아니므로 무시합니다.
    
    * 유효한 직선(등차수열)이라면, $N$개의 모든 점 $l$에 대해 $A[l]$이 이 직선 위에 있는지($O(N)$) 확인하여 총 $k$를 셉니다. $\to$ $O(N^3)$ 풀이 (시간 초과)

4.  **정해 ( $O(N^2 \log N)$ 또는 $O(N^2)$ ):**
    
    * $N$개의 점 중 **하나의 기준점 $(i, A[i])$**를 고정합니다. ($O(N)$)
    
    * 다른 모든 점 $(j, A[j])$ ($j \ne i$)에 대해 **기울기(공차)** $d = (A[j] - A[i]) / (j - i)$ 를 계산합니다.
    
    * (주의: $d$는 정수가 아닐 수 있으므로, 분수(기약분수) 형태 `pair<long long, long long>` 로 저장해야 합니다.)
    
    * 이 기울기 $d$들을 `map`이나 `unordered_map`에 저장하여, **"기준점 $i$와 동일한 기울기를 갖는 점이 몇 개인지"** 셉니다.
    
    * 가장 많이 등장한 기울기 $d_{max}$ 에 해당하는 점의 개수 + 1 (기준점 $i$ 자신)이, $i$를 포함하는 최대 등차수열의 크기입니다.
    
    * 모든 $i$에 대해 이 과정을 반복하여 $k$의 최댓값을 찾습니다.
    
    * 최종 답은 $N - k$ 입니다.


